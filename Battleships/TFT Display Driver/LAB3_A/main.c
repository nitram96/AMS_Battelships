/*
 * LAB3_A.c
 *
 * Created: 14-02-2018 21:31:04
 * Author : Rasmus BL
 */

#include <avr/io.h>
#define F_CPU 16000000
#include <util/delay.h>
#include "TFTdriver.h"
#include "XPT2046TouchDriver.h"

static const uint16_t bm[] PROGMEM = {
	 // 'Ship Button', 24x11px
	0xffff, 0xffff, 0xffff, 0x0000, 0x0000, 0x0000, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff,
	0xffff, 0xffff, 0xffff, 0x0000, 0xce79, 0x0000, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff,
	0xffff, 0xffff, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff,
	0xffff, 0xffff, 0x0000, 0xce79, 0xce79, 0xce79, 0x0000, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0x0000, 0x0000, 0x0000, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff,
	0xffff, 0xffff, 0x0000, 0xce79, 0xce79, 0xce79, 0x0000, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0x0000, 0xce79, 0x0000, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0x0000, 0x0000, 0xffff,
	0x0000, 0xce79, 0xce79, 0xce79, 0x0000, 0xce79, 0xce79, 0xce79, 0x0000, 0xce79, 0xce79, 0xce79, 0x0000, 0xce79, 0xce79, 0xce79, 0x0000, 0xce79, 0xce79, 0x0000, 0x0000, 0xffff, 0xffff, 0xffff,
	0xffff, 0x0000, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0xce79, 0x0000, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff,
	0xffff, 0x0000, 0xf8a0, 0xf800, 0xf8a0, 0xf8a0, 0xf8a0, 0xf8a0, 0xf8a0, 0xf8a0, 0xf8a0, 0xf8a0, 0xf8a0, 0xf8a0, 0xf8a0, 0xf8a0, 0xf8a0, 0x0000, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff,
	0xffff, 0xffff, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff};

//const unsigned char bm1[] PROGMEM = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x40,0x00,0x00,
	//0xC0,0x00,0x00,0x00,0xC0,0x00,0x00,0xC0,0x00,0x00,0x00,0xC0,0x00,0x00,0xC0,0x00,
	//0x00,0x00,0xC0,0x00,0x00,0xC0,0x00,0x00,0x00,0xC0,0x1F,0x83,0xF8,0x3F,0x81,0x9B,
	//0xF8,0x3F,0xE3,0xF8,0x7F,0xC1,0xBF,0xF8,0x70,0x70,0xC0,0xE0,0xE1,0xE8,0xC0,0x60,
	//0x30,0xC1,0xC0,0x61,0xC0,0xC0,0x60,0x00,0xC1,0x80,0x61,0x80,0xC0,0x78,0x00,0xC0,
	//0x01,0xE1,0x80,0xC0,0x3F,0x80,0xC0,0x3F,0xE1,0x80,0xC0,0x07,0xF0,0xC0,0xFE,0x61,
	//0x80,0xC0,0x00,0x78,0xC1,0xC0,0x61,0x80,0xC0,0x60,0x18,0xC1,0x80,0x61,0x80,0xC0,
	//0x70,0x18,0xC1,0x80,0xE1,0x80,0xC0,0x38,0x38,0xC1,0xC1,0xE1,0x80,0xC0,0x3F,0xF0,
	//0xF8,0xFF,0x61,0x80,0xF8,0x0F,0xC0,0x78,0x7C,0x31,0x80,0x78,0x00,0x00,0x00,0x00,
	//0x00,0x00,0x00};

int main(void)
{
	int16_t x = 0, y = 0;
	//unsigned int *x = 0, *y = 0;
	int touchDataReady;
	
    DisplayInit();
	touchInit();
	
	drawGameboard();
	//drawBitmap(50,50,bm,24,11);
	
	
    while (1) 
    {
		touchDataReady = touchReady();
		
		if(touchDataReady)
			{
				//drawGameboard();
				touchMeassure();
				//testTouch();
				x = touchXPos();
				y = touchYPos();
				
				if(x == 0 && y == 0)
				{
					//drawBitmap(x,y,bm,24,11);
					FillRectangle(0,0,MAX_WIDTH,MAX_HEIGHT,0,63,0);
				}
				
				if(x > 0 && y > 0)
				{
					//drawBitmap(x,y,bm,24,11);
					FillRectangle(0,0,MAX_WIDTH,MAX_HEIGHT,31,0,0);
				}
				//FillRectangle(0,0,MAX_WIDTH,MAX_HEIGHT,31,0,0);
			}

				
		//if(!rbi(TOUCH_IRQ_PORT, TOUCH_IRQ_BIT))
		//{
			//testRead(&xPos, &yPos);
			//if(xPos > 0 && yPos > 0)
			//drawBitmap(xPos,yPos,bm,24,11);			
		//}
				
		
		//_delay_ms(10);
		//drawGameboard();
		//drawBitmap(50+x,50,bm,24,11);
		//x++;
    }
}


